<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Blog Manager - Basic Version</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f8f9fa;
      padding: 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    .header {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .blogs-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 25px;
      margin-top: 20px;
    }

    .blog-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 3px 15px rgba(0,0,0,0.08);
      transition: transform 0.3s ease;
    }

    .blog-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }

    .blog-image-container {
      width: 100%;
      height: 220px;
      overflow: hidden;
    }

    .blog-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .blog-card:hover .blog-image {
      transform: scale(1.05);
    }

    .blog-content {
      padding: 20px;
    }

    .blog-title {
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 10px;
      color: #333;
      line-height: 1.4;
    }

    .blog-excerpt {
      color: #666;
      margin-bottom: 15px;
      line-height: 1.6;
      font-size: 0.95rem;
    }

    .blog-meta {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid #eee;
      font-size: 0.85rem;
    }

    .blog-category {
      background: #e74c3c;
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 500;
    }

    .blog-date {
      color: #888;
    }

    .blog-stats {
      display: flex;
      gap: 15px;
      margin-top: 10px;
    }

    .stat-item {
      display: flex;
      align-items: center;
      gap: 5px;
      color: #666;
      font-size: 0.85rem;
    }

    .stat-item i {
      color: #e74c3c;
    }

    .blog-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .btn {
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 0.9rem;
      font-weight: 500;
      transition: all 0.3s ease;
    }

    .btn-view {
      background: #3498db;
      color: white;
      border: none;
    }

    .btn-view:hover {
      background: #2980b9;
    }

    .btn-edit {
      background: #f39c12;
      color: white;
      border: none;
    }

    .btn-edit:hover {
      background: #d68910;
    }

    .btn-delete {
      background: #e74c3c;
      color: white;
      border: none;
    }

    .btn-delete:hover {
      background: #c0392b;
    }

    .loading-spinner {
      text-align: center;
      padding: 50px;
      color: #666;
    }

    .no-blogs {
      text-align: center;
      padding: 50px;
      color: #888;
    }

    .no-blogs i {
      font-size: 3rem;
      margin-bottom: 20px;
      color: #ddd;
    }

    @media (max-width: 768px) {
      .blogs-grid {
        grid-template-columns: 1fr;
      }
      
      .blog-image-container {
        height: 200px;
      }
    }

    @media (max-width: 480px) {
      .blog-actions {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="d-flex justify-content-between align-items-center">
        <div>
          <h1 class="h3 mb-2">
            <i class="fas fa-blog text-danger me-2"></i>
            Blog Management
          </h1>
          <p class="text-muted mb-0">Manage and view your blog posts</p>
        </div>
        <div class="d-flex gap-2">
          <button class="btn btn-outline-danger" onclick="refreshBlogs()">
            <i class="fas fa-sync-alt me-2"></i>Refresh
          </button>
          <button class="btn btn-danger" onclick="openCreateModal()">
            <i class="fas fa-plus me-2"></i>Add Blog
          </button>
        </div>
      </div>
    </div>

    <!-- Alert Container -->
    <div id="alertBox" class="mb-4"></div>

    <!-- Blogs Grid -->
    <div class="blogs-grid" id="blogsGrid">
      <div class="loading-spinner">
        <div class="spinner-border text-danger" role="status">
          <span class="visually-hidden">Loading...</span>
        </div>
        <p class="mt-3">Loading blogs...</p>
      </div>
    </div>

    <!-- No Blogs Message Template -->
    <div id="noBlogsTemplate" class="no-blogs" style="display: none;">
      <i class="fas fa-newspaper"></i>
      <h4>No blogs found</h4>
      <p class="text-muted">Start by creating your first blog post!</p>
      <button class="btn btn-danger mt-3" onclick="openCreateModal()">
        <i class="fas fa-plus me-2"></i>Create Blog
      </button>
    </div>
  </div>

  <!-- Simple Create/Edit Modal -->
  <div class="modal fade" id="blogModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header bg-danger text-white">
          <h5 class="modal-title" id="modalTitle">
            <i class="fas fa-plus me-2"></i>Create Blog
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="blogForm" onsubmit="saveBlog(event)">
            <input type="hidden" id="blogId">
            
            <div class="mb-3">
              <label class="form-label">Title *</label>
              <input type="text" class="form-control" id="title" required placeholder="Enter blog title">
            </div>
            
            <div class="mb-3">
              <label class="form-label">Content *</label>
              <textarea class="form-control" id="content" rows="6" required placeholder="Write your blog content here..."></textarea>
            </div>
            
            <div class="mb-3">
              <label class="form-label">Excerpt</label>
              <textarea class="form-control" id="excerpt" rows="3" placeholder="Brief description (optional)"></textarea>
            </div>
            
            <div class="row">
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Category *</label>
                  <select class="form-select" id="category" required>
                    <option value="">Select Category</option>
                    <option value="Technology">Technology</option>
                    <option value="Business">Business</option>
                    <option value="Health">Health</option>
                    <option value="Lifestyle">Lifestyle</option>
                    <option value="Education">Education</option>
                  </select>
                </div>
              </div>
              <div class="col-md-6">
                <div class="mb-3">
                  <label class="form-label">Image URL</label>
                  <input type="text" class="form-control" id="imageUrl" placeholder="https://example.com/image.jpg">
                  <small class="text-muted">Enter image URL or leave empty for default</small>
                </div>
              </div>
            </div>
            
            <div class="d-flex justify-content-end gap-2 mt-4">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
              <button type="submit" class="btn btn-danger">
                <i class="fas fa-save me-2"></i>Save Blog
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    // API Configuration - Update with your backend URL
    const API_BASE = "http://localhost:5000/api";
    const BLOGS_API = `${API_BASE}/blogs`;
    
    // Sample data for testing if API is not available
    const sampleBlogs = [
      {
        _id: "1",
        title: "Getting Started with Web Development",
        content: "Web development is the work involved in developing a website for the Internet or an intranet. Web development can range from developing a simple single static page of plain text to complex web applications, electronic businesses, and social network services.",
        excerpt: "Learn the basics of web development and start your journey today.",
        category: "Technology",
        image: "https://images.unsplash.com/photo-1555066931-4365d14bab8c?w=400&h=200&fit=crop",
        views: 150,
        likes: 25,
        comments: 8,
        createdAt: "2024-01-15"
      },
      {
        _id: "2",
        title: "The Future of Artificial Intelligence",
        content: "Artificial intelligence is transforming every industry. From healthcare to finance, AI is making processes more efficient and creating new opportunities. In this blog, we explore the future possibilities of AI technology.",
        excerpt: "Exploring how AI will shape our future world and what to expect.",
        category: "Technology",
        image: "https://images.unsplash.com/photo-1677442136019-21780ecad995?w=400&h=200&fit=crop",
        views: 320,
        likes: 45,
        comments: 12,
        createdAt: "2024-01-20"
      },
      {
        _id: "3",
        title: "Healthy Living in 2024",
        content: "Maintaining a healthy lifestyle is more important than ever. With simple changes to your daily routine, you can improve your physical and mental wellbeing. This blog covers practical tips for healthy living.",
        excerpt: "Simple tips and tricks for maintaining a healthy lifestyle.",
        category: "Health",
        image: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w-400&h=200&fit=crop",
        views: 210,
        likes: 32,
        comments: 15,
        createdAt: "2024-01-10"
      }
    ];

    let currentBlogs = [];
    let blogModal = null;

    // Initialize
    document.addEventListener('DOMContentLoaded', () => {
      // Initialize modal
      blogModal = new bootstrap.Modal(document.getElementById('blogModal'));
      
      // Load blogs
      loadBlogs();
    });

    // Show alert message
    function showAlert(message, type = 'info') {
      const alertBox = document.getElementById('alertBox');
      const alert = document.createElement('div');
      alert.className = `alert alert-${type} alert-dismissible fade show`;
      alert.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      `;
      alertBox.appendChild(alert);
      
      // Auto remove after 5 seconds
      setTimeout(() => {
        alert.remove();
      }, 5000);
    }

    // Load blogs from API or use sample data
    async function loadBlogs() {
      try {
        // Show loading state
        const blogsGrid = document.getElementById('blogsGrid');
        blogsGrid.innerHTML = `
          <div class="loading-spinner">
            <div class="spinner-border text-danger" role="status">
              <span class="visually-hidden">Loading...</span>
            </div>
            <p class="mt-3">Loading blogs...</p>
          </div>
        `;

        // Try to fetch from API
        const response = await fetch(BLOGS_API);
        
        if (response.ok) {
          const data = await response.json();
          currentBlogs = data.data || data.blogs || [];
        } else {
          // Fallback to sample data
          currentBlogs = sampleBlogs;
          showAlert('Using sample data. Connect to your backend for real data.', 'warning');
        }
      } catch (error) {
        // Use sample data if API fails
        currentBlogs = sampleBlogs;
        showAlert('Connected to sample data. Check your backend connection.', 'warning');
      }
      
      displayBlogs();
    }

    // Display blogs in grid
    function displayBlogs() {
      const blogsGrid = document.getElementById('blogsGrid');
      const noBlogsTemplate = document.getElementById('noBlogsTemplate');
      
      if (currentBlogs.length === 0) {
        blogsGrid.innerHTML = '';
        noBlogsTemplate.style.display = 'block';
        return;
      }
      
      noBlogsTemplate.style.display = 'none';
      
      let blogsHTML = '';
      
      currentBlogs.forEach(blog => {
        // Format data
        const title = blog.title || 'Untitled Blog';
        const content = blog.content || '';
        const excerpt = blog.excerpt || (content.length > 150 ? content.substring(0, 150) + '...' : content);
        const category = blog.category || 'General';
        const imageUrl = blog.image || 'https://images.unsplash.com/photo-1499750310107-5fef28a66643?w=400&h=200&fit=crop';
        const views = blog.views || 0;
        const likes = blog.likes || 0;
        const comments = blog.comments || 0;
        
        // Format date
        let formattedDate = 'Recently';
        if (blog.createdAt) {
          const date = new Date(blog.createdAt);
          formattedDate = date.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'short',
            day: 'numeric'
          });
        }
        
        blogsHTML += `
          <div class="blog-card">
            <div class="blog-image-container">
              <img src="${imageUrl}" 
                   alt="${title}" 
                   class="blog-image"
                   onerror="this.src='https://images.unsplash.com/photo-1499750310107-5fef28a66643?w=400&h=200&fit=crop'">
            </div>
            <div class="blog-content">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <span class="blog-category">${category}</span>
                <span class="blog-date">${formattedDate}</span>
              </div>
              <h3 class="blog-title">${title}</h3>
              <p class="blog-excerpt">${excerpt}</p>
              
              <div class="blog-stats">
                <div class="stat-item">
                  <i class="fas fa-eye"></i>
                  <span>${views}</span>
                </div>
                <div class="stat-item">
                  <i class="fas fa-thumbs-up"></i>
                  <span>${likes}</span>
                </div>
                <div class="stat-item">
                  <i class="fas fa-comment"></i>
                  <span>${comments}</span>
                </div>
              </div>
              
              <div class="blog-actions">
                <button class="btn btn-view" onclick="viewBlog('${blog._id}')">
                  <i class="fas fa-eye me-1"></i> View
                </button>
                <button class="btn btn-edit" onclick="editBlog('${blog._id}')">
                  <i class="fas fa-edit me-1"></i> Edit
                </button>
                <button class="btn btn-delete" onclick="deleteBlog('${blog._id}')">
                  <i class="fas fa-trash me-1"></i> Delete
                </button>
              </div>
            </div>
          </div>
        `;
      });
      
      blogsGrid.innerHTML = blogsHTML;
    }

    // Open create modal
    window.openCreateModal = function() {
      document.getElementById('blogForm').reset();
      document.getElementById('blogId').value = '';
      document.getElementById('modalTitle').innerHTML = '<i class="fas fa-plus me-2"></i>Create Blog';
      blogModal.show();
    };

    // Edit blog
    function editBlog(blogId) {
      const blog = currentBlogs.find(b => b._id === blogId);
      if (!blog) {
        showAlert('Blog not found', 'danger');
        return;
      }
      
      // Populate form
      document.getElementById('blogId').value = blog._id;
      document.getElementById('title').value = blog.title || '';
      document.getElementById('content').value = blog.content || '';
      document.getElementById('excerpt').value = blog.excerpt || '';
      document.getElementById('category').value = blog.category || '';
      document.getElementById('imageUrl').value = blog.image || '';
      
      document.getElementById('modalTitle').innerHTML = '<i class="fas fa-edit me-2"></i>Edit Blog';
      blogModal.show();
    }

    // Save blog
    async function saveBlog(event) {
      event.preventDefault();
      
      const blogId = document.getElementById('blogId').value;
      const title = document.getElementById('title').value;
      const content = document.getElementById('content').value;
      const excerpt = document.getElementById('excerpt').value;
      const category = document.getElementById('category').value;
      const imageUrl = document.getElementById('imageUrl').value;
      
      if (!title || !content || !category) {
        showAlert('Please fill in all required fields', 'warning');
        return;
      }
      
      // Create blog object
      const blogData = {
        title,
        content,
        excerpt,
        category,
        image: imageUrl || 'https://images.unsplash.com/photo-1499750310107-5fef28a66643?w=400&h=200&fit=crop',
        views: 0,
        likes: 0,
        comments: 0,
        createdAt: new Date().toISOString()
      };
      
      if (blogId) {
        // Update existing blog
        const index = currentBlogs.findIndex(b => b._id === blogId);
        if (index !== -1) {
          currentBlogs[index] = { ...currentBlogs[index], ...blogData };
        }
        showAlert('Blog updated successfully!', 'success');
      } else {
        // Create new blog
        blogData._id = Date.now().toString();
        currentBlogs.unshift(blogData);
        showAlert('Blog created successfully!', 'success');
      }
      
      // Close modal and refresh display
      blogModal.hide();
      displayBlogs();
    }

    // Delete blog
    function deleteBlog(blogId) {
      if (!confirm('Are you sure you want to delete this blog?')) {
        return;
      }
      
      currentBlogs = currentBlogs.filter(blog => blog._id !== blogId);
      displayBlogs();
      showAlert('Blog deleted successfully!', 'success');
    }

    // View blog (simple alert for demo)
    function viewBlog(blogId) {
      const blog = currentBlogs.find(b => b._id === blogId);
      if (blog) {
        alert(`Viewing: ${blog.title}\n\n${blog.content}`);
      }
    }

    // Refresh blogs
    window.refreshBlogs = function() {
      loadBlogs();
      showAlert('Blogs refreshed!', 'info');
    };
  </script>
</body>
</html>